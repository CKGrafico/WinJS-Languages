/*
    This is a simple library to help you managing languages on Windows 8.1 with WinJS
    author: @CKGrafico
    version: 1.0
*/
(function(e){"use strict";var t=Windows.Storage.ApplicationData.current;var n=t.roamingSettings;var r=Windows.ApplicationModel.Resources.Core.ResourceContext.getForCurrentView();var i=new Windows.UI.Popups.PopupMenu;var s=WinJS.Class.define(function(){this.setCurrent(n.values["WinjsLanguages"]?JSON.parse(n.values["WinjsLanguages"]):null||{label:r.languages[0],id:r.languages[0]}||{label:"English",id:"en-US"})},{translate:function(e){var t=WinJS.Resources.getString(e);if(!t.empty){return t.value}return"*"+e},setCurrent:function(e){Windows.Globalization.ApplicationLanguages.primaryLanguageOverride=e.id;n.values["WinjsLanguages"]=JSON.stringify({id:e.id,label:e.label});this.language=e},getCurrent:function(){return this.language},list:{},add:function(e){if(!Array.isArray(e)){e=[e]}for(var t=0;t<e.length;t++){this.list[e[t].id]=e[t].label||e[t].id;i.commands.append(new Windows.UI.Popups.UICommand(e[t].label,null,e[t].id))}},show:function(t){var t=t||this.point||{x:window.innerWidth-100,y:window.innerHeight-100};i.showAsync(t).then(function(t){if(t){e.languages.setCurrent(t)}})}});e.languages=new s;e.translate=languages.translate;if(e.Handlebars){Handlebars.registerHelper("i18n",translate)}})(window)