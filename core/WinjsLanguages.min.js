/*
    This is a simple library to help you managing languages on Windows 8.1 with WinJS
    author: @CKGrafico
    version: 1.0
*/
!function(n){"use strict";var e=Windows.Storage.ApplicationData.current,a=e.roamingSettings,i=Windows.ApplicationModel.Resources.Core.ResourceContext.getForCurrentView(),t=new Windows.UI.Popups.PopupMenu,s=WinJS.Class.define(function(){this.setCurrent(a.values.WinjsLanguages?JSON.parse(a.values.WinjsLanguages):null||{label:i.languages[0],id:i.languages[0]}||{label:"English",id:"en-US"})},{translate:function(n){var e=WinJS.Resources.getString(n);return e.empty?"*"+n:e.value},setCurrent:function(n){"object"!=typeof n&&(n={id:n,label:n}),Windows.Globalization.ApplicationLanguages.primaryLanguageOverride=n.id,a.values.WinjsLanguages=JSON.stringify(n),this.language=n},getCurrent:function(){return this.language},list:{},add:function(n){Array.isArray(n)||(n=[n]);for(var e=0;e<n.length;e++)this.list[n[e].id]=n[e].label||n[e].id,t.commands.append(new Windows.UI.Popups.UICommand(n[e].label,null,n[e].id))},show:function(e){var e=e||this.point||{x:window.innerWidth-100,y:window.innerHeight-100};t.showAsync(e).then(function(e){e&&n.languages.setCurrent(e)})}});n.languages=new s,n.translate=languages.translate,n.Handlebars&&Handlebars.registerHelper("i18n",translate)}(window);
